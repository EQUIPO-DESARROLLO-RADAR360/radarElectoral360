@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
@import 'flowbite';
@import 'flowbite/dist/flowbite.min.css';
@import 'datatables.net-dt/css/jquery.dataTables.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    font-family: 'Roboto', sans-serif;
    background-color: #f8fafc;
    color: #1e293b;
    transition-property: color, background-color;
    transition-duration: 300ms;
    overflow-y: scroll;
    /* Force scrollbar to prevent layout shift */
  }

  body[data-theme='dark'] {
    background-color: #0f172a;
    color: #e2e8f0;
  }
}

@layer components {

  /* Alias .sidebar styles if needed, or rely on legacy. 
     We focus on fixing the layout margins and theme support. */
  .sidebar {
    @apply fixed inset-y-0 left-0 z-40 flex w-64 -translate-x-full flex-col border-r border-slate-200 bg-white text-slate-800 shadow-2xl shadow-slate-200/60 backdrop-blur transition-all duration-300 dark:border-slate-800/60 dark:bg-slate-900/95 dark:text-gray-100 dark:shadow-slate-900/40;
  }

  /* Support BOTH .main-shell (new) and .main-wrapper (legacy) */
  .main-shell,
  .main-wrapper {
    @apply flex min-h-screen flex-1 flex-col bg-white transition-[margin] duration-300 dark:bg-slate-900/60;
  }

  /* Ensure top-header respects dark mode if it relies on default bg */
  .top-header {
    @apply dark:bg-slate-900 dark:border-b dark:border-slate-800 transition-colors duration-300;
  }

  .btn-icon {
    @apply inline-flex h-8 w-8 items-center justify-center rounded-lg text-sm font-medium transition duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500;
  }

  /* DataTables Dark Mode Overrides - ROBUST */
  [data-theme='dark'] .dataTables_wrapper {
    color: #cbd5e1 !important;
    /* slate-300 */
  }

  /* Table Background & Borders */
  [data-theme='dark'] table.dataTable {
    background-color: #0f172a !important;
    /* slate-900 */
    border-color: #1e293b !important;
    /* slate-800 */
    border-bottom: 1px solid #1e293b !important;
  }

  /* Header */
  [data-theme='dark'] table.dataTable thead th,
  [data-theme='dark'] table.dataTable thead td {
    background-color: #020617 !important;
    /* slate-950 */
    border-bottom: 1px solid #1e293b !important;
    /* slate-800 */
    color: #f8fafc !important;
    /* slate-50 */
  }

  /* Body Rows & Cells */
  [data-theme='dark'] table.dataTable tbody tr {
    background-color: #0f172a !important;
    /* slate-900 */
    color: #cbd5e1 !important;
    /* slate-300 */
    border-color: #1e293b !important;
  }

  [data-theme='dark'] table.dataTable tbody tr.odd {
    background-color: #0f172a !important;
  }

  [data-theme='dark'] table.dataTable tbody tr.even {
    background-color: #1e293b !important;
    /* slate-800 slight contrast if needed, or keep slate-900 */
  }

  [data-theme='dark'] table.dataTable tbody td {
    border-color: #1e293b !important;
    /* slate-800 */
  }

  /* Hover */
  [data-theme='dark'] table.dataTable tbody tr:hover,
  [data-theme='dark'] table.dataTable tbody tr:hover>.sorting_1 {
    background-color: #1e293b !important;
    /* slate-800 */
    color: #f8fafc !important;
  }

  /* FORCE CUSTOM CONTROLS DARK MODE (Select, Input) */
  /* Target specific input types to override generic forms.css or flowbite */
  [data-theme='dark'] input[type="text"],
  [data-theme='dark'] select,
  [data-theme='dark'] .dataTables_filter input,
  [data-theme='dark'] .dataTables_length select {
    background-color: rgba(15, 23, 42, 0.4) !important;
    /* slate-900/40 */
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    /* white/10 */
    color: #e2e8f0 !important;
    /* slate-200 */
  }

  /* Focus states for custom controls */
  [data-theme='dark'] input[type="text"]:focus,
  [data-theme='dark'] select:focus {
    background-color: rgba(15, 23, 42, 0.6) !important;
    border-color: #3b82f6 !important;
    /* blue-500 */
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3) !important;
  }

  /* Options within selects usually need opaque bg */
  [data-theme='dark'] select option {
    background-color: #0f172a !important;
    /* slate-900 */
    color: #e2e8f0 !important;
  }

  /* Pagination Buttons - Ghost/Outline Style */
  [data-theme='dark'] .dataTables_paginate .paginate_button,
  [data-theme='dark'] button.paginate_button {
    background-color: rgba(15, 23, 42, 0.4) !important;
    /* slate-900/40 */
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    /* white/10 */
    color: #cbd5e1 !important;
    /* slate-300 */
  }

  [data-theme='dark'] .dataTables_paginate .paginate_button:hover,
  [data-theme='dark'] button.paginate_button:hover {
    background-color: rgba(255, 255, 255, 0.05) !important;
    /* white/5 */
    color: #ffffff !important;
    border-color: rgba(255, 255, 255, 0.2) !important;
  }

  [data-theme='dark'] .dataTables_paginate .paginate_button:disabled,
  [data-theme='dark'] button.paginate_button:disabled {
    background-color: transparent !important;
    color: #475569 !important;
    /* slate-600 */
    border-color: rgba(255, 255, 255, 0.05) !important;
    cursor: not-allowed !important;
  }

  /* Update actual Button overrides just in case class mismatch */
  /* Target the specific "Actualizar" button pattern used in Blade */
  [data-theme='dark'] button.inline-flex.items-center.gap-2.border.bg-white,
  [data-theme='dark'] .top-header button.bg-white {
    background-color: rgba(15, 23, 42, 0.4) !important;
    /* bg-slate-900/40 */
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    /* border-white/10 */
    color: #e2e8f0 !important;
    /* text-slate-200 */
  }

  [data-theme='dark'] button.inline-flex.items-center.gap-2.border.bg-white:hover,
  [data-theme='dark'] .top-header button.bg-white:hover {
    background-color: rgba(255, 255, 255, 0.05) !important;
  }

  /* Additional Pagination Specific Overrides */
  [data-theme='dark'] .dataTables_paginate button,
  [data-theme='dark'] .dataTables_wrapper button.paginate_button {
    background-color: rgba(15, 23, 42, 0.4) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    color: #cbd5e1 !important;
  }

  [data-theme='dark'] .dataTables_paginate button:hover,
  [data-theme='dark'] .dataTables_wrapper button.paginate_button:hover {
    background-color: rgba(255, 255, 255, 0.05) !important;
    color: #ffffff !important;
  }

  /* Info & Pagination */
  [data-theme='dark'] .dataTables_wrapper .dataTables_info,
  [data-theme='dark'] .dataTables_wrapper .dataTables_processing,
  [data-theme='dark'] .dataTables_wrapper .dataTables_paginate {
    color: #94a3b8 !important;
    /* slate-400 */
  }

  /* --- SCOPED OVERRIDES FOR EVENTOS MODULE --- */
  /* These only apply when body has .theme-eventos class */

  /* Scoped Header Fix */
  body.theme-eventos [data-theme='dark'] .top-header {
    background-color: #0f172a !important;
    /* slate-900 */
    border-color: #1e293b !important;
    /* slate-800 */
  }

  body.theme-eventos [data-theme='dark'] .top-header .material-icons-outlined,
  body.theme-eventos [data-theme='dark'] .top-header .material-icons,
  body.theme-eventos [data-theme='dark'] .top-header button {
    color: #e2e8f0 !important;
  }

  body.theme-eventos [data-theme='dark'] .top-header button:hover {
    background-color: rgba(255, 255, 255, 0.05) !important;
  }

  /* Scoped Ghost Controls (Inputs / Selects) */
  body.theme-eventos [data-theme='dark'] input[type="text"],
  body.theme-eventos [data-theme='dark'] select,
  body.theme-eventos [data-theme='dark'] .dataTables_filter input,
  body.theme-eventos [data-theme='dark'] .dataTables_length select {
    background-color: rgba(15, 23, 42, 0.4) !important;
    /* slate-900/40 */
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    /* white/10 */
    color: #e2e8f0 !important;
  }

  /* Scoped Pagination */
  body.theme-eventos [data-theme='dark'] .dataTables_paginate .paginate_button,
  body.theme-eventos [data-theme='dark'] button.paginate_button,
  body.theme-eventos [data-theme='dark'] .eventos-pagination-btn {
    background-color: rgba(15, 23, 42, 0.4) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    color: #cbd5e1 !important;
  }

  body.theme-eventos [data-theme='dark'] .dataTables_paginate .paginate_button:hover,
  body.theme-eventos [data-theme='dark'] button.paginate_button:hover,
  body.theme-eventos [data-theme='dark'] .eventos-pagination-btn:hover {
    background-color: rgba(255, 255, 255, 0.05) !important;
    color: #ffffff !important;
  }

  /* Scoped Filter Buttons */
  body.theme-eventos [data-theme='dark'] .eventos-filter-btn:not(.bg-blue-600):not(.bg-emerald-600):not(.bg-slate-600) {
    background-color: rgba(15, 23, 42, 0.4) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    color: #e2e8f0 !important;
  }

  body.theme-eventos [data-theme='dark'] .eventos-filter-btn:not(.bg-blue-600):hover {
    background-color: rgba(255, 255, 255, 0.05) !important;
  }

  /* --- END SCOPED OVERRIDES --- */

  [data-theme='dark'] .dataTables_wrapper .dataTables_paginate .paginate_button.current,
  [data-theme='dark'] .dataTables_wrapper .dataTables_paginate .paginate_button.current:hover {
    color: white !important;
    background: #2563eb !important;
    /* blue-600 */
    border-color: #1e40af !important;
  }

  [data-theme='dark'] .dataTables_wrapper .dataTables_paginate .paginate_button.disabled,
  [data-theme='dark'] .dataTables_wrapper .dataTables_paginate .paginate_button.disabled:hover,
  [data-theme='dark'] .dataTables_wrapper .dataTables_paginate .paginate_button.disabled:active {
    color: #475569 !important;
    /* slate-600 */
    background: transparent !important;
    border-color: #1e293b !important;
    cursor: not-allowed;
  }
}

@layer utilities {
  .sidebar.active {
    @apply translate-x-0;
  }

  .sidebar.collapsed {
    @apply w-20;
  }

  .sidebar.collapsed .sidebar-text {
    @apply hidden;
  }

  .sidebar.collapsed .material-symbols-rounded {
    @apply mr-0;
  }

  #sidebarOverlay {
    @apply fixed inset-0 z-30 hidden bg-slate-900/60 backdrop-blur;
  }

  #sidebarOverlay.active {
    @apply block;
  }
}

@layer components {
  .dataTables_paginate .paginate_button {
    @apply text-sm rounded-lg px-3 py-1 font-medium bg-gray-50 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700;
  }
}

@media (min-width: 1024px) {
  .sidebar {
    transform: translateX(0);
  }

  /* Apply margin logic to BOTH .main-shell and .main-wrapper */
  body.sidebar-collapsed .main-shell,
  body.sidebar-collapsed .main-wrapper {
    margin-left: 5rem;
  }

  body:not(.sidebar-collapsed) .main-shell,
  body:not(.sidebar-collapsed) .main-wrapper {
    margin-left: 16rem;
  }

  #sidebarOverlay {
    display: none !important;
  }
}

/* --- SCOPED OVERRIDES FOR EVENTOS MODULE (Re-applied) --- */
/* Target ID #eventos-page which wraps the EventosIndex component */

[data-theme='dark'] #eventos-page .eventos-filter-btn:not(.is-active),
[data-theme='dark'] #eventos-page .eventos-pagination-btn {
  background-color: rgba(15, 23, 42, 0.4) !important;
  /* slate-900/40 */
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
  /* white/10 */
  color: #e2e8f0 !important;
  /* slate-200 */
}

[data-theme='dark'] #eventos-page .eventos-filter-btn:not(.is-active):hover,
[data-theme='dark'] #eventos-page .eventos-pagination-btn:hover {
  background-color: rgba(255, 255, 255, 0.05) !important;
  /* white/5 */
  color: #ffffff !important;
}

/* Active State (Selected Filter) */
[data-theme='dark'] #eventos-page .eventos-filter-btn.is-active {
  /* Retain specific color logic via utility classes + specific overrides if needed, 
     but user asked for blue active state. The Vue binding handles colored active states (blue, emerald, slate).
     We just ensure border/color contrast is correct. */
  border-color: transparent !important;
  color: #fff !important;
}

/* Disabled State */
[data-theme='dark'] #eventos-page .eventos-pagination-btn:disabled {
  opacity: 0.5 !important;
  cursor: not-allowed !important;
  /* background-color: transparent !important; REMOVED */
}